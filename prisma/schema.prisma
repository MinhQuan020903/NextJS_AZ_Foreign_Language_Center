generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}


//MSHV, họ tên, ngày sinh, số điện thoại, email.
//MSGV, họ tên, ngày sinh, số điện thoại, email, CCCD, trình độ, MHSL.


model User {
  id       Int     @id @default(autoincrement())
  name     String
  email    String  @unique
  password String
  role     String? @default("user")
  avatar   String? @default("https://i0.wp.com/www.repol.copl.ulaval.ca/wp-content/uploads/2019/01/default-user-icon.jpg?ssl=1")
  address  String? @default("VietNam")
  birthDay DateTime?
  indexSalary Int?
  level Int?
  assignment_users Assignment_User[]
}

model IndexSalary{
    id       Int     @id @default(autoincrement())
    value   Int
}
//MKH,loại, trình độ, số học viên, ngày bắt đầu, số buổi học, MKH đề xuất, học phí, tiền công mỗi buổi học, MLKH.
model Course{
    id       Int     @id @default(autoincrement())
    module   Int
    level    String
    countStudent  Int @default(0)
    startTime DateTime
    endTime   DateTime
    number    Int @default(8)
    fee    Int
    cost   Int
    otherCourseId   Int
    classSessions ClassSession[]

}

//MBH, MKH, MGV, MPH, ngày học, ca học.
//ClassSession = BuoiHoc classShift là ca học

model ClassSession{
      id       Int     @id @default(autoincrement())
      courseId  Int
      Course    Course @relation(fields: [courseId], references: [id])

      teacherId Int
      roomId    Int
      StartTime DateTime
      classShiftId Int
      classShift ClassShift @relation(fields: [classShiftId], references: [id])
      @@index([courseId])
      @@index([classShiftId])
Assignment_ClassSessions Assignment_ClassSession[]
}
// MCH, thời gian.: classShift= Ca học
model ClassShift{
        id       Int     @id @default(autoincrement())
        name     String
        classsessions ClassSession[]
}

//Phòng: MP, tên phòng, sức chứa, trạng thái, loại phòng.
model Room{
        id       Int     @id @default(autoincrement())
        name     String
        value    Int
        status   String? @default("Free")
        typeId   Int
        type     RoomType @relation(fields: [typeId], references: [id])
        note     String?
       
        @@index([typeId])
        facilities Facility[]
}

model RoomType{
        id       Int     @id @default(autoincrement())
        name     String
        rooms Room[]
}

//MCSVC, tên cơ sở vật chất, giá trị.
model Facility{
        id       Int     @id @default(autoincrement())
        name     String
        value   Int
        roomId  Int
        room Room @relation(fields: [roomId], references: [id])
        @@index([roomId])

}






// Bài tập: Assignment: MBT, loại kỹ năng, trình độ, ngày tạo. Bài tập

model Assignment{
        id        Int     @id @default(autoincrement())
        name      String
        type      String
        level     String
        startTime DateTime
        files     String?       @db.LongText
        Assignment_ClassSessions Assignment_ClassSession[]
        Assignment_Users Assignment_User[]
}
// BaiTap_BuoiHoc(Id, MaBuoiHoc, MaBaiTap, deadline )

model Assignment_ClassSession{
        id                    Int     @id @default(autoincrement())
        classSessionId              Int
        classSession                ClassSession @relation(fields: [classSessionId], references: [id])
        assignmentId          Int
        assignment            Assignment @relation(fields: [assignmentId], references: [id])
        @@index([assignmentId])
        @@index([classSessionId])
}
// BaiTap_HocVien(Id, Mã học viên, Id_BaiTap_BuoiHoc, trạng thái, nhận xét, link)
model Assignment_User{
        id                    Int     @id @default(autoincrement())
        userId              Int
        user                User @relation(fields: [userId], references: [id])
        assignmentId          Int
        assignment            Assignment @relation(fields: [assignmentId], references: [id])
        @@index([assignmentId])
        @@index([userId])
}

